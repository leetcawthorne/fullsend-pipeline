<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>{{ page.title }} | FullSend Passive V1</title>

  <!-- Favicon -->
  <link rel="icon" href="{{ site.baseurl }}{{ site.favicon }}" />

  <!-- Styles -->
  <link rel="stylesheet" href="{{ '/assets/css/style.css' | relative_url }}" />

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet" />
</head>
<body>

  <!-- Header -->
  <header class="site-header">
    <div class="nav-container">
      <a href="{{ site.baseurl }}/" class="brand">
        <img id="site-logo" src="{{ site.logo | relative_url }}" alt="FullSend Logo" />
      </a>
      <nav class="nav-links">
        <a href="{{ site.baseurl }}/">Home</a>
        <a href="{{ site.baseurl }}/about">About</a>
        <a href="{{ site.baseurl }}/contact">Contact</a>
      </nav>
    </div>
  </header>

  <!-- Page content -->
  <main class="content">
    {{ content }}
  </main>

  <!-- Footer -->
  <footer class="footer">
    <p>© {{ site.time | date: "%Y" }} FullSend Automation — Powered by AI Pipelines</p>
  </footer>

  <!-- DVOS Script -->
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      // 1️⃣ Determine background
      let bgPath;
      {% if page.collection == "dvos" and page.background_asset %}
        bgPath = "{{ page.background_asset | relative_url }}";
      {% else %}
        bgPath = "{{ '/assets/images/header-bg.jpg' | relative_url }}";
      {% endif %}
      document.body.style.backgroundImage = `url('${bgPath}')`;
      document.body.style.backgroundSize = "cover";
      document.body.style.backgroundPosition = "center";

      // 2️⃣ Apply logo dynamically if present
      const logoElement = document.querySelector('img#site-logo');
      {% if page.logo %}
      if (logoElement) {
        logoElement.src = "{{ page.logo | relative_url }}";
        logoElement.style.maxWidth = "200px";
        logoElement.style.height = "auto";
      }
      {% endif %}


      // 3️⃣ Store theme and button assets for JS
      window.dvosThemes = {
        light: "{{ page.theme_light | relative_url }}",
        dark: "{{ page.theme_dark | relative_url }}"
      };
      window.dvosButtons = {
        primarySvg: "{{ page.button_primary_svg | relative_url }}",
        secondarySvg: "{{ page.button_secondary_svg | relative_url }}",
        primaryJson: "{{ page.button_primary_json | relative_url }}",
        secondaryJson: "{{ page.button_secondary_json | relative_url }}"
      };
      window.visualProfilePath = "{{ page.visual_profile | relative_url }}";

      // 4️⃣ Fetch visual profile JSON (only if defined)
      if (window.visualProfilePath) {
        fetch(window.visualProfilePath)
          .then(response => {
            if (!response.ok) throw new Error("Visual profile not found");
            return response.json();
          })
          .then(data => {
            console.log("✅ Visual Profile Loaded:", data);

            if (data.theme_alignment && data.theme_alignment.includes("dark")) {
              document.body.classList.add("dark-mode");
            } else {
              document.body.classList.remove("dark-mode");
            }

            if (data.profile === "Energetic Creator") {
              document.documentElement.style.setProperty('--accent-color', '#FF4B2B');
              document.documentElement.style.setProperty('--accent-hover', '#FF6A3D');
            }
          })
          .catch(error => console.warn("⚠️ Visual Profile Load Error:", error));
      }
    });
  </script>

</body>
</html>
